{% extends 'webapp/base.html' %}

{% block one %}
<!-- About Container -->
<div style="margin-left: 15px; margin-top: 7px; margin-bottom: -50px;"><strong>Legend:</strong>
    <p><img src="http://www.robotwoods.com/dev/misc/bluecircle.png"> Current Location</p>
</div>

<div class="w3-container" id="about">
  <div class="w3-content" style="max-width:700px">
    <a href="{% url 'webapp:get_locations' %}"><h5 class="w3-center w3-padding-64" id="nearby_locs"><span class="w3-tag w3-wide">GET NEARBY SAFE AND UNSAFE LOCATIONS</span></h5></a>
    <p>Click on the above button to find all the nearby safe and unsafe locations in times of emergencies.</p>
    <p>On reaching the area, help us further promote an area as safe or demote it as unsafe using the Mobile Application</p>
  </div>
</div>

{% endblock %}

{% block two %}
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDv2lJm1ggUG25OhwdEtz_GYbWW8qwEK4U&callback=initMap"></script>
<script>
    function callAlert(){
        window.alert('Submitted. Thanks for providing the info');
        return false;
    }
    // Initialize and add the map
    function initMap() {
    var infoWindow = new google.maps.InfoWindow;
    // Try HTML5 geolocation.
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
        var curr_pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
        };
        var map = new google.maps.Map(
        document.getElementById('map'), {zoom: 15, center: curr_pos});
        var currentMarker = new google.maps.Marker({position: curr_pos, map:map, icon:{
            url:'http://www.robotwoods.com/dev/misc/bluecircle.png'
        }});
        // infoWindow.setPosition(pos);
        // infoWindow.setContent('Location found.');
        // infoWindow.open(map);
        map.setCenter(curr_pos);
        }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
        });
    } else {
      // Browser doesn't support Geolocation
        handleLocationError(false, infoWindow, map.getCenter());
    }
    }

    
  function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
                          'Error: The Geolocation service failed.' :
                          'Error: Your browser doesn\'t support geolocation.');
    infoWindow.open(map);
  }
</script>
{% endblock %}